{% extends "base.html" %}
{% block title %} Client Profile {% endblock %}

{% block content %}

<div class="container p-5">
 <div class="profile-info">
  
   <!-- Profile information section -->
   <div class="row">
         <!-- Display the client's profile picture -->
         <div class="col-md-4">
             <div class="profile-picture-container">
               <img src="{{ profile_picture }}" class="profile-picture" alt="Profile Picture">
             </div>
         </div>

          <!-- Client information section -->
         <div class="col-md-8 pt-3 ">
              <!-- Display the client's first name, last name, and email -->
              <h2 class="pb-3">{{ user.first_name }} {{ user.last_name }}</h2>
              <p><strong>Email:</strong> {{ user.email }}</p>

              <!-- Display the client's stats -->
              <p><strong>Age:</strong> {{ age }} </p>
              <p><strong>Gender:</strong> {{ user.gender.capitalize() }} </p>

                    <form method="POST" enctype="multipart/form-data" style="display: none;" id="client_pfp">
                        <!-- Profile picture -->
                        <div class="form-group">
                          <label for="profile_picture">Profile Picture:</label>
                          <input type="file" class="form-control-file form-control" id="profile_picture" name="profile_picture">
                          <button type="submit" class="btn btn-success mt-3">Save</button>
                        </div>
                    </form>

         </div>
    </div> 
 </div>

<div class="bs-doc-section personal-info pt-2 mt-5 mb-0">
    <h3 class="pb-3">Personal Information</h3>

    <p><strong>Height:</strong> {{ user.height }} cm</p>
    <p><strong>Weight:</strong> {{ user.weight }} kg</p>
    <p><strong>BMI:</strong> {{ user.bmi }}</p>
    {% if user.goal %}
    <p><strong>Goal:</strong> {{ user.goal.capitalize() }}</p>
    {% endif %}
    <p><strong>Desired Weight:</strong> {{ user.desired_weight }} kg</p>
    <p><strong>Goal Date:</strong> {{ user.desired_date }}</p>

    <button id="edit_client_profile_btn" class="btn btn-primary">Edit Profile</button>

   <!-- Form to update profile information -->
   <div class="info-update">

      <form method="POST" id="client_profile_info" style="display: none;" class="col-md-3">

        <!-- Height -->
        <div class="form-group">
          <label for="height">Height (cm):</label>
          <input type="number" class="form-control" id="height" name="height" value="{{ user.height }}">
        </div>

        <!-- Weight -->
        <div class="form-group">
          <label for="weight">Weight (kg):</label>
          <input type="number" class="form-control" id="weight" name="weight" value="{{ user.weight }}">
        </div>

        <!-- Goal -->
        <div class="form-group">
            <label for="goal">Goal:</label>
            <select class="form-control" name="goal" required>
              <option value="lose weight">Lose weight</option>
              <option value="build muscle">Build muscle</option>
              <option value="both">Both</option>
            </select>
        </div>

        <!-- Desired Weight -->
        <div class="form-group">
          <label for="desired-weight">Desired Weight (kg):</label>
          <input type="number" class="form-control" id="desired-weight" name="desired-weight" value="{{ user.desired_weight }}">
        </div>

        <!-- Goal Date -->
        <div class="form-group">
            <label for="desired-date">Goal Date:</label>
            <input type="date" class="form-control" id="desired-date" name="desired-date" value="{{ user.desired_date }}">
        </div>

        <!-- Submit button -->
        <button type="submit" class="btn btn-primary mt-3">Update</button>
      </form>
   </div>

   <!-- Form to update Medical History -->

    <button id="edit-history-btn" class="btn btn-primary mt-2">Edit Medical History</button>

    <form id="afflictions-form" method="POST" style="display: none;">
  
      <div id="afflictions-section">
        <p>Name all afflictions you suffer from, if any:</p>
        <div class="input-group form-group mb-3">
          <div class="col-md-4">
            <input type="text" name="new-affliction" id="new-affliction" class="form-control" placeholder="Enter affliction">
          </div>
          <button type="submit" id="add-affliction-button" class="btn btn-primary">Add</button>  
        </div>
      </div>

    </form>

    <form id="medication-form" method="POST" style="display: none;">
      <div id="medication-section">
        <p>Name all the medications you are currently taking, if any:</p>
        <div class="input-group form-group mb-3 col-md-4">
          <div class="col-md-4">
            <input type="text" name="new-medication" class="form-control" id="new-medication" placeholder="Enter medication">
          </div>
          <button type="submit" id="add-medication-button" class="btn btn-primary">Add</button>  
        </div>
      </div>
    </form>

    <form id="allergies-form" method="POST" style="display: none;">
      <div id="allergies-section">
        <p>Name all of your allergies and intolerances, if any:</p>
        <div class="input-group form-group mb-3">
          <div class="col-md-4">
            <input type="text" name="new-allergy" id="new-allergy" class="form-control" placeholder="Enter allergy/intolerance">
          </div>
          <button type="submit" id="add-allergy-button" class="btn btn-primary">Add</button>  
        </div>
      </div>
    </form>

</div>

{% include "meal_plan.html" %}
</div>
<script>
    $(document).ready(function () {
    $("#edit_client_profile_btn").click(function () {
        $("#client_profile_info, #client_pfp").toggle();
    });

    $("#edit-history-btn").click(function () {
        $("#afflictions-form, #medication-form, #allergies-form").toggle();
    });
});

</script>
{% endblock %}

